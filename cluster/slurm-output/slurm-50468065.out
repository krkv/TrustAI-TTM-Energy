wandb: Currently logged in as: rodion-ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.16.3
wandb: Run data is saved locally in /gpfs/space/home/rodion/ttm/TrustAI-TTM-Energy/cluster/wandb/run-20240301_004545-j9r1m7lo
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run classic-violet-33
wandb: ‚≠êÔ∏è View project at https://wandb.ai/rodion-ai/project-ttm
wandb: üöÄ View run at https://wandb.ai/rodion-ai/project-ttm/runs/j9r1m7lo
Loaded configs...
Loading model and tokenizer...
You are using the default legacy behaviour of the <class 'transformers.models.t5.tokenization_t5.T5Tokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
Special tokens have been added in the vocabulary, make sure the associated word embeddings are fine-tuned or trained.
Loading train and val sets...
  0%|          | 0/604 [00:00<?, ?it/s] 14%|‚ñà‚ñç        | 86/604 [00:00<00:00, 859.80it/s] 28%|‚ñà‚ñà‚ñä       | 172/604 [00:00<00:00, 560.00it/s] 49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 296/604 [00:00<00:00, 800.39it/s] 69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 417/604 [00:00<00:00, 937.20it/s] 86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 520/604 [00:00<00:00, 718.12it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 604/604 [00:00<00:00, 772.92it/s]
  0%|          | 0/604 [00:00<?, ?it/s]prompt id 139 has nothing in it! skipping over it
 51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 307/604 [00:00<00:00, 3066.98it/s]100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 604/604 [00:00<00:00, 3842.92it/s]
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
Train dataset shape: (13078, 2)
Creating data loaders...
Setting up optimizer...
Beginning fine-tuning...
epoch 0 | step 0 | loss: tensor(5.3855, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 0 | step 100 | loss: tensor(0.7048, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 0 | step 200 | loss: tensor(0.2787, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 0 | step 300 | loss: tensor(0.1318, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 0 | step 400 | loss: tensor(0.0871, device='cuda:0', grad_fn=<NllLossBackward0>)
`num_beams` is set to 1. However, `early_stopping` is set to `True` -- this flag is only used in beam-based generation modes. You should set `num_beams>1` or unset `early_stopping`.
Validated 0
Validated 50
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
0 | mean validation loss: 0.005319712683558464
0 | generation samples
                                                preds                                               gold
0   filter indoor_temperature less than 15.25 and ...  filter indoor_temperature less than 15.25 and ...
1   filter indoor_temperature equal to 13.25 or fi...  filter indoor_temperature equal to 13.25 or fi...
2   filter indoor_temperature greater than 13.25 a...  filter indoor_temperature greater than 13.25 a...
3   filter outdoor_temperature less equal than 21....  filter outdoor_temperature less equal than 21....
4   filter outdoor_temperature greater than 21.5 a...  filter outdoor_temperature greater than 21.5 a...
..                                                ...                                                ...
95  filter past_electricity greater than 1929.025 ...  filter past_electricity greater than 1929.025 ...
96  filter past_electricity greater than 1929.025 ...  filter past_electricity greater than 1929.025 ...
97  filter indoor_temperature equal to 13.25 and m...  filter indoor_temperature equal to 13.25 and m...
98  filter indoor_temperature greater than 15.25 a...  filter indoor_temperature greater than 15.25 a...
99  predictionfilter non_semantic_class_names and ...  predictionfilter non_semantic_class_names and ...

[100 rows x 2 columns]
Saving model...
Saved model model at ./parsing/t5/models/energy_t5-small_epoch_0_lr_0.0001_batchsize_32_optimizer_adamw_downsample_1.0!
epoch 1 | step 0 | loss: tensor(0.1066, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 1 | step 100 | loss: tensor(0.0820, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 1 | step 200 | loss: tensor(0.0492, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 1 | step 300 | loss: tensor(0.0519, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 1 | step 400 | loss: tensor(0.0564, device='cuda:0', grad_fn=<NllLossBackward0>)
`num_beams` is set to 1. However, `early_stopping` is set to `True` -- this flag is only used in beam-based generation modes. You should set `num_beams>1` or unset `early_stopping`.
Validated 0
Validated 50
1 | mean validation loss: 0.0023661458399146795
1 | generation samples
                                                preds                                               gold
0   filter past_electricity equal to 1 std and sta...                     statistic past_electricity [e]
1   filter indoor_temperature greater than 15.25 a...  filter indoor_temperature greater than 15.25 a...
2   filter past_electricity greater than 1929.025 ...  filter outdoor_temperature greater than 21.5 a...
3   filter indoor_temperature less than 13.25 and ...  filter indoor_temperature less than 13.25 and ...
4   filter indoor_temperature equal to 15.25 and p...  filter indoor_temperature equal to 15.25 and p...
..                                                ...                                                ...
95  filter indoor_temperature equal to 15.25 and s...  filter indoor_temperature equal to 15.25 and s...
96  filter outdoor_temperature greater than 21.823...  filter outdoor_temperature greater than 21.823...
97  filter indoor_temperature equal to 13.25 and c...  filter indoor_temperature equal to 13.25 and c...
98  filter past_electricity less than 1929.025 and...  filter past_electricity less than 1929.025 and...
99                      filter indoor_temperature [e]                   statistic indoor_temperature [e]

[100 rows x 2 columns]
Saving model...
Saved model model at ./parsing/t5/models/energy_t5-small_epoch_1_lr_0.0001_batchsize_32_optimizer_adamw_downsample_1.0!
epoch 2 | step 0 | loss: tensor(0.0854, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 2 | step 100 | loss: tensor(0.0424, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 2 | step 200 | loss: tensor(0.0648, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 2 | step 300 | loss: tensor(0.0781, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 2 | step 400 | loss: tensor(0.0434, device='cuda:0', grad_fn=<NllLossBackward0>)
`num_beams` is set to 1. However, `early_stopping` is set to `True` -- this flag is only used in beam-based generation modes. You should set `num_beams>1` or unset `early_stopping`.
Validated 0
Validated 50
2 | mean validation loss: 0.0016333662206307054
2 | generation samples
                                                preds                                               gold
0   filter past_electricity greater than 1929.025 ...  filter past_electricity greater than 1929.025 ...
1   filter indoor_temperature greater than 15.25 a...  filter indoor_temperature greater than 15.25 a...
2   filter indoor_temperature less than 13.25 and ...  filter indoor_temperature less than 13.25 and ...
3   filter past_electricity less equal than 640.4 ...  filter past_electricity less equal than 640.4 ...
4   filter indoor_temperature less than 15.25 and ...  filter indoor_temperature less than 15.25 and ...
..                                                ...                                                ...
95  filter outdoor_temperature greater than 21.823...  filter outdoor_temperature greater than 21.823...
96  filter past_electricity greater than 640.4 and...  filter past_electricity greater than 640.4 and...
97  filter past_electricity not equal to 640.4 and...  filter past_electricity not equal to 640.4 and...
98  filter indoor_temperature less equal than 15.2...  filter indoor_temperature less equal than 15.2...
99  filter indoor_temperature less than 13.25 and ...  filter indoor_temperature less than 13.25 and ...

[100 rows x 2 columns]
Saving model...
Saved model model at ./parsing/t5/models/energy_t5-small_epoch_2_lr_0.0001_batchsize_32_optimizer_adamw_downsample_1.0!
epoch 3 | step 0 | loss: tensor(0.0313, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 3 | step 100 | loss: tensor(0.0243, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 3 | step 200 | loss: tensor(0.0635, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 3 | step 300 | loss: tensor(0.0434, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 3 | step 400 | loss: tensor(0.0175, device='cuda:0', grad_fn=<NllLossBackward0>)
`num_beams` is set to 1. However, `early_stopping` is set to `True` -- this flag is only used in beam-based generation modes. You should set `num_beams>1` or unset `early_stopping`.
Validated 0
Validated 50
3 | mean validation loss: 0.0013488347176462412
3 | generation samples
                                                preds                                               gold
0   filter indoor_temperature greater than 15.25 a...  filter indoor_temperature greater than 15.25 a...
1   filter outdoor_temperature less equal than 21....  filter outdoor_temperature less equal than 21....
2   predictionfilter non_semantic_class_names and ...  predictionfilter non_semantic_class_names and ...
3   filter outdoor_temperature greater than 21.823...  filter outdoor_temperature greater than 21.823...
4   filter indoor_temperature greater than 15.25 a...  filter indoor_temperature greater than 15.25 a...
..                                                ...                                                ...
95        filter id 89 and filter id 90 and label [e]        filter id 89 and filter id 90 and label [e]
96  filter past_electricity greater than 640.4 and...  filter past_electricity greater than 640.4 and...
97  filter past_electricity greater than 1929.025 ...  filter past_electricity greater than 1929.025 ...
98  filter outdoor_temperature less than 21.823995...  filter outdoor_temperature less than 21.823995...
99  filter outdoor_temperature greater than 21.5 a...  filter outdoor_temperature greater than 21.5 a...

[100 rows x 2 columns]
Saving model...
Saved model model at ./parsing/t5/models/energy_t5-small_epoch_3_lr_0.0001_batchsize_32_optimizer_adamw_downsample_1.0!
epoch 4 | step 0 | loss: tensor(0.0461, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 4 | step 100 | loss: tensor(0.0254, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 4 | step 200 | loss: tensor(0.0174, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 4 | step 300 | loss: tensor(0.0450, device='cuda:0', grad_fn=<NllLossBackward0>)
epoch 4 | step 400 | loss: tensor(0.0441, device='cuda:0', grad_fn=<NllLossBackward0>)
`num_beams` is set to 1. However, `early_stopping` is set to `True` -- this flag is only used in beam-based generation modes. You should set `num_beams>1` or unset `early_stopping`.
Validated 0
Validated 50
4 | mean validation loss: 0.0011824410175904632
4 | generation samples
                                                preds                                               gold
0   filter outdoor_temperature not equal to 21.5 a...  filter outdoor_temperature not equal to 21.5 a...
1   filter past_electricity not equal to 640.4 and...  filter past_electricity not equal to 640.4 and...
2   predictionfilter non_semantic_class_names and ...  predictionfilter non_semantic_class_names and ...
3   filter outdoor_temperature not equal to 21.5 a...  filter outdoor_temperature not equal to 21.5 a...
4   filter indoor_temperature less than 13.25 and ...  filter indoor_temperature less than 13.25 and ...
..                                                ...                                                ...
95  filter indoor_temperature greater than 13.25 a...  filter indoor_temperature greater than 13.25 a...
96  filter past_electricity greater equal than 192...  filter past_electricity greater equal than 192...
97  filter outdoor_temperature greater than 21.5 a...  filter outdoor_temperature greater than 21.5 a...
98  filter outdoor_temperature less than 21.823995...  filter outdoor_temperature less than 21.823995...
99  filter indoor_temperature greater than 13.25 a...  filter indoor_temperature greater than 13.25 a...

[100 rows x 2 columns]
Saving model...
Saved model model at ./parsing/t5/models/energy_t5-small_epoch_4_lr_0.0001_batchsize_32_optimizer_adamw_downsample_1.0!
Done (‚â°^‚àá^‚â°)
wandb: - 0.175 MB of 0.175 MB uploadedwandb: \ 0.175 MB of 0.175 MB uploadedwandb: | 0.175 MB of 0.175 MB uploadedwandb: / 0.179 MB of 0.193 MB uploaded (0.002 MB deduped)wandb: - 0.193 MB of 0.193 MB uploaded (0.002 MB deduped)wandb: 
wandb: Run history:
wandb:    Epoch ‚ñÅ‚ñÉ‚ñÖ‚ñÜ‚ñà
wandb: Val Loss ‚ñà‚ñÉ‚ñÇ‚ñÅ‚ñÅ
wandb: 
wandb: Run summary:
wandb:          Epoch 4
wandb:       Val Loss 0.00118
wandb: best_val_epoch 4
wandb:  best_val_loss 0.00118
wandb: 
wandb: üöÄ View run classic-violet-33 at: https://wandb.ai/rodion-ai/project-ttm/runs/j9r1m7lo
wandb: Ô∏è‚ö° View job at https://wandb.ai/rodion-ai/project-ttm/jobs/QXJ0aWZhY3RDb2xsZWN0aW9uOjE0NDI2OTEyOQ==/version_details/v2
wandb: Synced 5 W&B file(s), 5 media file(s), 7 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240301_004545-j9r1m7lo/logs
